# DEX Wrapper

ä¸€ä¸ªå¯æ‰©å±•çš„ DEX åŒ…è£…å™¨ï¼Œç”¨äºåœ¨ BSC ä¸ŠåŒ…è£… PancakeSwap V3ã€‚

## ğŸ“‹ æ¦‚è¿°

DEX Wrapper æ˜¯ä¸€ä¸ªæ™ºèƒ½åˆçº¦ç³»ç»Ÿï¼Œå®ƒï¼š

- **åŒ…è£… PancakeSwap V3 (BSC)**: é€šè¿‡è°ƒç”¨ PancakeSwap V3 çš„æµåŠ¨æ€§æ± å®Œæˆäº¤æ˜“
- **è´¹ç”¨æŠ½å–**: åœ¨æ¯ç¬”äº¤æ˜“ä¸­æ”¶å–ä¸€å®šæ¯”ä¾‹çš„è´¹ç”¨ä½œä¸ºé¡¹ç›®æ”¶ç›Š
- **å¯æ‰©å±•æ¶æ„**: ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œè½»æ¾æ”¯æŒæ–°çš„ DEX åè®®
- **å®‰å…¨å¯é **: é‡‡ç”¨ç”Ÿäº§ç¯å¢ƒè´¨é‡æ ‡å‡†ï¼ŒåŒ…å«é‡å…¥ä¿æŠ¤ã€è®¿é—®æ§åˆ¶ç­‰å®‰å…¨æªæ–½

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶

1. **IDexAdapter** - æŠ½è±¡æ¥å£å±‚ï¼Œå®šä¹‰ç»Ÿä¸€çš„ DEX äº¤äº’æ¥å£
2. **PancakeSwapV3Adapter** - PancakeSwap V3 (BSC) é€‚é…å™¨å®ç°
3. **FeeManager** - è´¹ç”¨ç®¡ç†åˆçº¦ï¼Œå¤„ç†è´¹ç”¨è®¡ç®—å’Œæ”¶é›†
4. **DexWrapperRouter** - ä¸»è·¯ç”±åˆçº¦ï¼Œæ•´åˆé€‚é…å™¨å’Œè´¹ç”¨ç®¡ç†å™¨

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      DexWrapperRouter               â”‚  â† ç”¨æˆ·äº¤äº’å…¥å£
â”‚  (æ•´åˆé€‚é…å™¨å’Œè´¹ç”¨ç®¡ç†)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†•              â†•
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ FeeManagerâ”‚    â”‚ Adapters â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†•
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  PancakeSwapV3Adapter    â”‚  â† BSC
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
cd packages/dex-wrapper
pnpm install
```

### ç¼–è¯‘åˆçº¦

```bash
pnpm compile
```

### è¿è¡Œæµ‹è¯•

```bash
pnpm test
```

### ä»£ç è¦†ç›–ç‡

```bash
pnpm test:coverage
```

## ğŸ“ åˆçº¦è¯´æ˜

### FeeManager

è´¹ç”¨ç®¡ç†åˆçº¦ï¼Œè´Ÿè´£ï¼š
- è®¡ç®—äº¤æ˜“è´¹ç”¨ï¼ˆåŸºäºåŸºç¡€ç‚¹ï¼Œ1 åŸºç¡€ç‚¹ = 0.01%ï¼‰
- æ”¶é›†è´¹ç”¨å¹¶è½¬ç§»åˆ°æŒ‡å®šåœ°å€
- æœ€å¤§è´¹ç”¨ç‡é™åˆ¶ä¸º 10%ï¼ˆ1000 åŸºç¡€ç‚¹ï¼‰

**å…³é”®å‚æ•°**:
- `feeRate`: è´¹ç”¨ç‡ï¼ˆåŸºç¡€ç‚¹ï¼‰ï¼Œé»˜è®¤ 10 (0.1%)
- `feeRecipient`: è´¹ç”¨æ¥æ”¶åœ°å€

### PancakeSwapV3Adapter

PancakeSwap V3 é€‚é…å™¨ï¼Œå®ç° `IDexAdapter` æ¥å£ï¼š
- `swapExactInputSingle`: ç²¾ç¡®è¾“å…¥äº¤æ¢
- `swapExactOutputSingle`: ç²¾ç¡®è¾“å‡ºäº¤æ¢
- `getQuote`: è·å–ä»·æ ¼æŠ¥ä»·

**PancakeSwap V3 åœ°å€ (BSC Mainnet)**:
- SwapRouter: `0x13f4EA83D0bd40E75C8222255bc855a974568Dd4`
- Quoter: `0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997`

### DexWrapperRouter

ä¸»è·¯ç”±åˆçº¦ï¼Œæä¾›ï¼š
- ç»Ÿä¸€çš„äº¤æ¢æ¥å£
- è‡ªåŠ¨è´¹ç”¨æ”¶é›†
- é€‚é…å™¨ç®¡ç†
- ç´§æ€¥æš‚åœåŠŸèƒ½

## ğŸ”§ é…ç½®

### ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# BSC Network
BSC_MAINNET_RPC=https://bsc-dataseed.binance.org/
BSC_TESTNET_RPC=https://data-seed-prebsc-1-s1.binance.org:8545/

# Private Key
PRIVATE_KEY=your_private_key

# API Keys
BSCSCAN_API_KEY=your_bscscan_api_key
```

## ğŸ“¦ éƒ¨ç½²

### æœ¬åœ°éƒ¨ç½²

```bash
pnpm deploy:local
```

### BSC æµ‹è¯•ç½‘éƒ¨ç½²

```bash
pnpm deploy:testnet
```

### BSC ä¸»ç½‘éƒ¨ç½²

```bash
pnpm deploy:mainnet
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… **é‡å…¥ä¿æŠ¤**: ä½¿ç”¨ `ReentrancyGuard` é˜²æ­¢é‡å…¥æ”»å‡»
- âœ… **è®¿é—®æ§åˆ¶**: ä½¿ç”¨ `Ownable` è¿›è¡Œæƒé™ç®¡ç†
- âœ… **æš‚åœåŠŸèƒ½**: ç´§æ€¥æƒ…å†µä¸‹å¯æš‚åœåˆçº¦
- âœ… **è¾“å…¥éªŒè¯**: æ‰€æœ‰è¾“å…¥å‚æ•°éƒ½ç»è¿‡éªŒè¯
- âœ… **è´¹ç”¨é™åˆ¶**: æœ€å¤§è´¹ç”¨ç‡é™åˆ¶ä¸º 10%
- âœ… **å®‰å…¨è½¬è´¦**: ä½¿ç”¨ `SafeERC20` è¿›è¡Œä»£å¸è½¬è´¦

## ğŸ§ª æµ‹è¯•

æµ‹è¯•å¥—ä»¶åŒ…æ‹¬ï¼š
- éƒ¨ç½²æµ‹è¯•
- è´¹ç”¨ç®¡ç†æµ‹è¯•
- äº¤æ¢æ“ä½œæµ‹è¯•
- è®¿é—®æ§åˆ¶æµ‹è¯•
- æš‚åœåŠŸèƒ½æµ‹è¯•

è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼š

```bash
pnpm test
```

## ğŸ”® æœªæ¥æ‰©å±•

### æ”¯æŒå…¶ä»– DEX

ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œå®ç° `IDexAdapter` æ¥å£å³å¯æ·»åŠ æ–°çš„ DEX æ”¯æŒï¼š
- å…¶ä»–é“¾ä¸Šçš„ PancakeSwap V3
- å…¶ä»– AMM åè®®

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [Hardhat 3 æ–‡æ¡£](https://hardhat.org/docs/getting-started)
- [PancakeSwap V3 æ–‡æ¡£](https://developer.pancakeswap.finance/contracts/infinity/overview)
- [OpenZeppelin Contracts](https://docs.openzeppelin.com/contracts)

## ğŸ“„ è®¸å¯è¯

GPL-3.0

